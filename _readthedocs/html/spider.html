<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>spider package &mdash; spider-st v0.0.2 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #6a65d8" >

          
          
          <a href="index.html">
            
              <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">General</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="API.html">API Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #6a65d8" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">spider-st</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">spider package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/spider.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="spider-package">
<h1>spider package<a class="headerlink" href="#spider-package" title="Permalink to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="spider.R_script.html">spider.R_script package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="spider.R_script.html#module-spider.R_script">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="spider.SpatialDE2.html">spider.SpatialDE2 package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="spider.SpatialDE2.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="spider.SpatialDE2.html#module-spider.SpatialDE2.aeh">spider.SpatialDE2.aeh module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatternParameters"><code class="docutils literal notranslate"><span class="pre">SpatialPatternParameters</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatternParameters.eta_1"><code class="docutils literal notranslate"><span class="pre">SpatialPatternParameters.eta_1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatternParameters.eta_2"><code class="docutils literal notranslate"><span class="pre">SpatialPatternParameters.eta_2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatternParameters.gamma_1"><code class="docutils literal notranslate"><span class="pre">SpatialPatternParameters.gamma_1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatternParameters.gamma_2"><code class="docutils literal notranslate"><span class="pre">SpatialPatternParameters.gamma_2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatternParameters.lengthscales"><code class="docutils literal notranslate"><span class="pre">SpatialPatternParameters.lengthscales</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatternParameters.maxiter"><code class="docutils literal notranslate"><span class="pre">SpatialPatternParameters.maxiter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatternParameters.method"><code class="docutils literal notranslate"><span class="pre">SpatialPatternParameters.method</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatternParameters.nclasses"><code class="docutils literal notranslate"><span class="pre">SpatialPatternParameters.nclasses</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatternParameters.pattern_prune_threshold"><code class="docutils literal notranslate"><span class="pre">SpatialPatternParameters.pattern_prune_threshold</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatternParameters.tol"><code class="docutils literal notranslate"><span class="pre">SpatialPatternParameters.tol</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatterns"><code class="docutils literal notranslate"><span class="pre">SpatialPatterns</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatterns.converged"><code class="docutils literal notranslate"><span class="pre">SpatialPatterns.converged</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatterns.elbo_trace"><code class="docutils literal notranslate"><span class="pre">SpatialPatterns.elbo_trace</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatterns.labels"><code class="docutils literal notranslate"><span class="pre">SpatialPatterns.labels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatterns.niter"><code class="docutils literal notranslate"><span class="pre">SpatialPatterns.niter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatterns.pattern_probabilities"><code class="docutils literal notranslate"><span class="pre">SpatialPatterns.pattern_probabilities</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatterns.patterns"><code class="docutils literal notranslate"><span class="pre">SpatialPatterns.patterns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.SpatialPatterns.status"><code class="docutils literal notranslate"><span class="pre">SpatialPatterns.status</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.aeh.spatial_patterns"><code class="docutils literal notranslate"><span class="pre">spatial_patterns()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spider.SpatialDE2.html#module-spider.SpatialDE2.de_test">spider.SpatialDE2.de_test module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.de_test.test"><code class="docutils literal notranslate"><span class="pre">test()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spider.SpatialDE2.html#module-spider.SpatialDE2.dp_hmrf">spider.SpatialDE2.dp_hmrf module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentation"><code class="docutils literal notranslate"><span class="pre">TissueSegmentation</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentation.class_probabilities"><code class="docutils literal notranslate"><span class="pre">TissueSegmentation.class_probabilities</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentation.converged"><code class="docutils literal notranslate"><span class="pre">TissueSegmentation.converged</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentation.elbo_trace"><code class="docutils literal notranslate"><span class="pre">TissueSegmentation.elbo_trace</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentation.gammahat_1"><code class="docutils literal notranslate"><span class="pre">TissueSegmentation.gammahat_1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentation.gammahat_2"><code class="docutils literal notranslate"><span class="pre">TissueSegmentation.gammahat_2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentation.labels"><code class="docutils literal notranslate"><span class="pre">TissueSegmentation.labels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentation.nclasses_trace"><code class="docutils literal notranslate"><span class="pre">TissueSegmentation.nclasses_trace</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentation.niter"><code class="docutils literal notranslate"><span class="pre">TissueSegmentation.niter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentation.prune_iterations"><code class="docutils literal notranslate"><span class="pre">TissueSegmentation.prune_iterations</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentation.status"><code class="docutils literal notranslate"><span class="pre">TissueSegmentation.status</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentationParameters"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationParameters</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentationParameters.abstol"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationParameters.abstol</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentationParameters.class_prune_threshold"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationParameters.class_prune_threshold</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentationParameters.eta_1"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationParameters.eta_1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentationParameters.eta_2"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationParameters.eta_2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentationParameters.gamma_1"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationParameters.gamma_1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentationParameters.gamma_2"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationParameters.gamma_2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentationParameters.maxiter"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationParameters.maxiter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentationParameters.nclasses"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationParameters.nclasses</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentationParameters.neighbors"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationParameters.neighbors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentationParameters.reltol"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationParameters.reltol</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentationParameters.smoothness_factor"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationParameters.smoothness_factor</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentationStatus"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationStatus</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentationStatus.AbsoluteToleranceReached"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationStatus.AbsoluteToleranceReached</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentationStatus.MaximumIterationsReached"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationStatus.MaximumIterationsReached</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.TissueSegmentationStatus.RelativeToleranceReached"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationStatus.RelativeToleranceReached</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.dp_hmrf.tissue_segmentation"><code class="docutils literal notranslate"><span class="pre">tissue_segmentation()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spider.SpatialDE2.html#module-spider.SpatialDE2.gaussian_process">spider.SpatialDE2.gaussian_process module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.GP"><code class="docutils literal notranslate"><span class="pre">GP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.GP.GPR"><code class="docutils literal notranslate"><span class="pre">GP.GPR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.GP.SGPR"><code class="docutils literal notranslate"><span class="pre">GP.SGPR</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.GPControl"><code class="docutils literal notranslate"><span class="pre">GPControl</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.GPControl.ard"><code class="docutils literal notranslate"><span class="pre">GPControl.ard</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.GPControl.gp"><code class="docutils literal notranslate"><span class="pre">GPControl.gp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.GPControl.ipm"><code class="docutils literal notranslate"><span class="pre">GPControl.ipm</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.GPControl.ncomponents"><code class="docutils literal notranslate"><span class="pre">GPControl.ncomponents</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.GPControl.ninducers"><code class="docutils literal notranslate"><span class="pre">GPControl.ninducers</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.SGPIPM"><code class="docutils literal notranslate"><span class="pre">SGPIPM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.SGPIPM.free"><code class="docutils literal notranslate"><span class="pre">SGPIPM.free</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.SGPIPM.grid"><code class="docutils literal notranslate"><span class="pre">SGPIPM.grid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.SGPIPM.random"><code class="docutils literal notranslate"><span class="pre">SGPIPM.random</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.fit"><code class="docutils literal notranslate"><span class="pre">fit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.fit_detailed"><code class="docutils literal notranslate"><span class="pre">fit_detailed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.fit_fast"><code class="docutils literal notranslate"><span class="pre">fit_fast()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.fit_model"><code class="docutils literal notranslate"><span class="pre">fit_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.gaussian_process.inducers_grid"><code class="docutils literal notranslate"><span class="pre">inducers_grid()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spider.SpatialDE2.html#module-spider.SpatialDE2.io">spider.SpatialDE2.io module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.io.read_spaceranger"><code class="docutils literal notranslate"><span class="pre">read_spaceranger()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spider.SpatialDE2.html#module-spider.SpatialDE2.svca">spider.SpatialDE2.svca module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.svca.fit_spatial_interactions"><code class="docutils literal notranslate"><span class="pre">fit_spatial_interactions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="spider.SpatialDE2.html#spider.SpatialDE2.svca.test_spatial_interactions"><code class="docutils literal notranslate"><span class="pre">test_spatial_interactions()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spider.SpatialDE2.html#module-spider.SpatialDE2">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="spider.lrdb.html">spider.lrdb package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="spider.lrdb.html#module-spider.lrdb">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-spider.SPIDER">
<span id="spider-spider-module"></span><h2>spider.SPIDER module<a class="headerlink" href="#module-spider.SPIDER" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="spider.SPIDER.SPIDER">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">spider.SPIDER.</span></span><span class="sig-name descname"><span class="pre">SPIDER</span></span><a class="reference internal" href="_modules/spider/SPIDER.html#SPIDER"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.SPIDER.SPIDER" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The <cite>SPIDER</cite> class encapsulates methods for processing spatial transcriptomics data.</p>
<p>The class provides functionality for constructing an interface data object from spatial transcriptomics (ST) data.
It supports various preprocessing steps, such as filtering, normalization, and imputation, to prepare the data for
downstream analysis of cell-cell interactions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="spider.SPIDER.SPIDER.cell_transform">
<span class="sig-name descname"><span class="pre">cell_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/SPIDER.html#SPIDER.cell_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.SPIDER.SPIDER.cell_transform" title="Permalink to this definition"></a></dt>
<dd><p>Transform cell data by integrating interaction scores and patterns.</p>
<p>This method updates the provided AnnData object (<cite>adata</cite>) with interaction patterns
and scores obtained from the input data (<cite>idata</cite>). It can also perform gene ranking
based on specified labels if provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idata</strong> (<em>AnnData</em>) – Input AnnData object containing interaction scores and patterns.</p></li>
<li><p><strong>adata</strong> (<em>AnnData</em>) – Input AnnData object to be updated with interaction data.</p></li>
<li><p><strong>label</strong> (<em>str</em><em>, </em><em>optional</em>) – The key for the label in <cite>idata.uns[‘cell_meta’]</cite> used for grouping cells
and performing rank gene analysis (default is None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – Updated AnnData object with added interaction patterns and scores.</p></li>
<li><p><strong>adata_lri</strong> (<em>AnnData</em>) – AnnData object containing interaction scores filtered by the specified label.</p></li>
<li><p><strong>adata_pattern</strong> (<em>AnnData</em>) – AnnData object containing interaction patterns filtered by the specified label.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function checks if the specified label exists in the <cite>cell_meta</cite> metadata. If it does, it computes ranking for genes based on interaction scores and patterns.</p></li>
<li><p>Small clusters (with only one cell) are excluded from the analysis to ensure meaningful group comparisons.</p></li>
<li><p>The spatial coordinates are preserved in the <cite>obsm</cite> attribute for both <cite>adata_lri</cite> and <cite>adata_pattern</cite>.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adata</span><span class="p">,</span> <span class="n">adata_lri</span><span class="p">,</span> <span class="n">adata_pattern</span> <span class="o">=</span> <span class="n">cell_transform</span><span class="p">(</span><span class="n">idata</span><span class="p">,</span> <span class="n">adata</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cell_type&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spider.SPIDER.SPIDER.find_svi">
<span class="sig-name descname"><span class="pre">find_svi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abstract</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern_prune_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predefined_pattern_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svi_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/SPIDER.html#SPIDER.find_svi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.SPIDER.SPIDER.find_svi" title="Permalink to this definition"></a></dt>
<dd><p>Find SVI and SVI patterns from interface idata.</p>
<p>This method processes the provided interface data to compute SVI and related patterns.
It can optionally perform abstraction based on the number of interfaces present.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idata</strong> (<em>AnnData</em>) – Input AnnData object containing interface data.</p></li>
<li><p><strong>out_f</strong> (<em>str</em>) – Output directory path where results will be saved.</p></li>
<li><p><strong>R_path</strong> (<em>str</em>) – Path to the R script or binary for external processing.</p></li>
<li><p><strong>abstract</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, performs abstraction on the data if the number of interfaces is sufficient (default is True).</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, overwrites existing output files (default is False).</p></li>
<li><p><strong>n_neighbors</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of neighbors to use for the abstraction process (default is 5).</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Alpha parameter for the abstraction algorithm (default is 0.3).</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold for filtering SVI candidates (default is 0.01).</p></li>
<li><p><strong>pattern_prune_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold for pruning patterns during SVI pattern generation (default is 1e-20).</p></li>
<li><p><strong>predefined_pattern_number</strong> (<em>int</em><em>, </em><em>optional</em>) – If set to a positive integer, limits the number of predefined patterns (default is -1, which means no limit).</p></li>
<li><p><strong>svi_number</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of SVI patterns to return (default is 10).</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of parallel jobs to run during processing (default is 10).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>idata</strong> (<em>AnnData</em>) – The updated AnnData object containing results of SVI and SVI patterns.</p></li>
<li><p><strong>meta_idata</strong> (<em>AnnData or None</em>) – The meta AnnData object containing abstraction results, or None if abstraction was not performed.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The method checks if the output directory exists and creates it if it doesn’t.</p></li>
<li><p>If the number of interfaces in <cite>idata</cite> is less than 1000, abstraction is skipped.</p></li>
<li><p>Various intermediate results are saved as CSV files in the specified output directory.</p></li>
<li><p>The method utilizes external R processing for some computations, requiring R to be installed and accessible. Otherwise, only the three python methods are used.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result_idata</span><span class="p">,</span> <span class="n">result_meta_idata</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">find_svi</span><span class="p">(</span><span class="n">idata</span><span class="p">,</span> <span class="s1">&#39;output_directory&#39;</span><span class="p">,</span> <span class="s1">&#39;/path/to/R&#39;</span><span class="p">,</span> <span class="n">abstract</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spider.SPIDER.SPIDER.find_svi_without_pattern">
<span class="sig-name descname"><span class="pre">find_svi_without_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abstract</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern_prune_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predefined_pattern_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svi_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/SPIDER.html#SPIDER.find_svi_without_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.SPIDER.SPIDER.find_svi_without_pattern" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spider.SPIDER.SPIDER.prep">
<span class="sig-name descname"><span class="pre">prep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'type'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_human</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imputation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pathway_raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_sc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_total</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/SPIDER.html#SPIDER.prep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.SPIDER.SPIDER.prep" title="Permalink to this definition"></a></dt>
<dd><p>Prepares the data for interface analysis by processing input AnnData.</p>
<p>This method subsets the input AnnData object to include only ligand-receptor
genes and transcription factor genes, constructs interfaces from the data,
and computes interface profiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata_input</strong> (<em>AnnData</em>) – Input AnnData object containing spatial transcriptomics data.</p></li>
<li><p><strong>cluster_key</strong> (<em>str</em><em>, </em><em>optional</em>) – Key in <cite>adata</cite> that denotes the cluster or cell type for analysis (default is ‘type’).</p></li>
<li><p><strong>is_human</strong> (<em>bool</em><em>, </em><em>optional</em>) – Indicates whether the input data is from human samples (default is True).</p></li>
<li><p><strong>cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold for filtering long-distance interactions (default is None, meaning no filtering).</p></li>
<li><p><strong>imputation</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, performs imputation on the input data (default is False).</p></li>
<li><p><strong>itermax</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of iterations for optimization algorithms (default is 1000).</p></li>
<li><p><strong>lr_raw</strong> (<em>DataFrame</em><em>, </em><em>optional</em>) – Predefined ligand-receptor pairs. If None, defaults to loading based on <cite>is_human</cite>.</p></li>
<li><p><strong>pathway_raw</strong> (<em>DataFrame</em><em>, </em><em>optional</em>) – Predefined pathways. If None, defaults to loading based on <cite>is_human</cite>.</p></li>
<li><p><strong>is_sc</strong> (<em>bool</em><em>, </em><em>optional</em>) – Indicates whether the input data is single-cell data (default is False).</p></li>
<li><p><strong>normalize_total</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, normalizes total counts in the <cite>adata</cite> object (default is False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>idata</strong> – An AnnData object constructed from the processed interface profiles and metadata.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>AnnData</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The method first creates a copy of the input AnnData object and releases the original.</p></li>
<li><p>It checks if ligand-receptor pairs and pathway data are provided; if not, it loads them based on the <cite>is_human</cite> flag.</p></li>
<li><p>Interfaces are constructed from the data, followed by scoring based on the provided parameters.</p></li>
<li><p>The resulting <cite>idata</cite> object contains computed scores and metadata for further analysis.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">idata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prep</span><span class="p">(</span><span class="n">adata_input</span><span class="p">,</span> <span class="n">cluster_key</span><span class="o">=</span><span class="s1">&#39;cell_type&#39;</span><span class="p">,</span> <span class="n">is_human</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spider.SPIDER.SPIDER.prep_compare">
<span class="sig-name descname"><span class="pre">prep_compare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'type'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_human</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imputation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_sc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_total</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/SPIDER.html#SPIDER.prep_compare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.SPIDER.SPIDER.prep_compare" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spider.SPIDER.SPIDER.prep_exp">
<span class="sig-name descname"><span class="pre">prep_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'type'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_human</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imputation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_sc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_total</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/SPIDER.html#SPIDER.prep_exp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.SPIDER.SPIDER.prep_exp" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-spider.enrichment">
<span id="spider-enrichment-module"></span><h2>spider.enrichment module<a class="headerlink" href="#module-spider.enrichment" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spider.enrichment.add_diff">
<span class="sig-prename descclassname"><span class="pre">spider.enrichment.</span></span><span class="sig-name descname"><span class="pre">add_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_to_add</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/enrichment.html#add_diff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.enrichment.add_diff" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.enrichment.enrichment">
<span class="sig-prename descclassname"><span class="pre">spider.enrichment.</span></span><span class="sig-name descname"><span class="pre">enrichment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">custom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">histology_results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pattern'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/enrichment.html#enrichment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.enrichment.enrichment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.enrichment.enrichment_interacrtion_gene_df">
<span class="sig-prename descclassname"><span class="pre">spider.enrichment.</span></span><span class="sig-name descname"><span class="pre">enrichment_interacrtion_gene_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lri_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'label'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_human</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_pathwaydb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/enrichment.html#enrichment_interacrtion_gene_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.enrichment.enrichment_interacrtion_gene_df" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.enrichment.enrichment_interacrtion_gene_list">
<span class="sig-prename descclassname"><span class="pre">spider.enrichment.</span></span><span class="sig-name descname"><span class="pre">enrichment_interacrtion_gene_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lri_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_human</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_pathwaydb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/enrichment.html#enrichment_interacrtion_gene_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.enrichment.enrichment_interacrtion_gene_list" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.enrichment.enrichment_interacrtion_list">
<span class="sig-prename descclassname"><span class="pre">spider.enrichment.</span></span><span class="sig-name descname"><span class="pre">enrichment_interacrtion_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lri_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_human</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/enrichment.html#enrichment_interacrtion_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.enrichment.enrichment_interacrtion_list" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.enrichment.load_pathway">
<span class="sig-prename descclassname"><span class="pre">spider.enrichment.</span></span><span class="sig-name descname"><span class="pre">load_pathway</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_human</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/enrichment.html#load_pathway"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.enrichment.load_pathway" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.enrichment.pathway_annotation">
<span class="sig-prename descclassname"><span class="pre">spider.enrichment.</span></span><span class="sig-name descname"><span class="pre">pathway_annotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_human</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/enrichment.html#pathway_annotation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.enrichment.pathway_annotation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.enrichment.pathway_annotation_list">
<span class="sig-prename descclassname"><span class="pre">spider.enrichment.</span></span><span class="sig-name descname"><span class="pre">pathway_annotation_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">LRI_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_human</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/enrichment.html#pathway_annotation_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.enrichment.pathway_annotation_list" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.enrichment.pathway_prep">
<span class="sig-prename descclassname"><span class="pre">spider.enrichment.</span></span><span class="sig-name descname"><span class="pre">pathway_prep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_human</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/enrichment.html#pathway_prep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.enrichment.pathway_prep" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.enrichment.pathway_prep_custom_background">
<span class="sig-prename descclassname"><span class="pre">spider.enrichment.</span></span><span class="sig-name descname"><span class="pre">pathway_prep_custom_background</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">background</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_human</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/enrichment.html#pathway_prep_custom_background"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.enrichment.pathway_prep_custom_background" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.enrichment.pattern_enrichment_edge">
<span class="sig-prename descclassname"><span class="pre">spider.enrichment.</span></span><span class="sig-name descname"><span class="pre">pattern_enrichment_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_human</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'label'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/enrichment.html#pattern_enrichment_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.enrichment.pattern_enrichment_edge" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.enrichment.pattern_enrichment_node">
<span class="sig-prename descclassname"><span class="pre">spider.enrichment.</span></span><span class="sig-name descname"><span class="pre">pattern_enrichment_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_human</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'label'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_pathwaydb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/enrichment.html#pattern_enrichment_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.enrichment.pattern_enrichment_node" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-spider.ot">
<span id="spider-ot-module"></span><h2>spider.ot module<a class="headerlink" href="#module-spider.ot" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.coo_submatrix_pull">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">coo_submatrix_pull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#coo_submatrix_pull"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.coo_submatrix_pull" title="Permalink to this definition"></a></dt>
<dd><p>Pulls out an arbitrary i.e. non-contiguous submatrix out of
a sparse.coo_matrix.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.cot_blk_dense">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">cot_blk_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#cot_blk_dense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.cot_blk_dense" title="Permalink to this definition"></a></dt>
<dd><p>Solve for each pair of species separately.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.cot_blk_sparse">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">cot_blk_sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#cot_blk_sparse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.cot_blk_sparse" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.cot_col_dense">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">cot_col_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#cot_col_dense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.cot_col_dense" title="Permalink to this definition"></a></dt>
<dd><p>Solve for each destination species separately.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.cot_col_sparse">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">cot_col_sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#cot_col_sparse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.cot_col_sparse" title="Permalink to this definition"></a></dt>
<dd><p>Solve for each destination species separately.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.cot_combine_sparse">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">cot_combine_sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.1,</span> <span class="pre">0.1,</span> <span class="pre">0.1,</span> <span class="pre">0.7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#cot_combine_sparse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.cot_combine_sparse" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.cot_dense">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">cot_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#cot_dense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.cot_dense" title="Permalink to this definition"></a></dt>
<dd><p>Solve the collective optimal transport problem with distance limits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S</strong> (<em>(</em><em>n_pos_s</em><em>,</em><em>ns_s</em><em>) </em><em>numpy.ndarray</em>) – Source distributions over <cite>n_pos_s</cite> positions of <cite>ns_s</cite> source species.</p></li>
<li><p><strong>D</strong> (<em>(</em><em>n_pos_d</em><em>,</em><em>ns_d</em><em>) </em><em>numpy.ndarray</em>) – Destination distributions over <cite>n_pos_d</cite> positions of <cite>ns_d</cite> destination species.</p></li>
<li><p><strong>A</strong> (<em>(</em><em>ns_s</em><em>,</em><em>ns_d</em><em>) </em><em>numpy.ndarray</em>) – The cost coefficients for source-destination species pairs. An infinity value indicates that the two species cannot be coupled.</p></li>
<li><p><strong>M</strong> (<em>(</em><em>n_pos_s</em><em>,</em><em>n_pos_d</em><em>) </em><em>numpy.ndarray</em>) – The distance (cost) matrix among the positions.</p></li>
<li><p><strong>cutoff</strong> (<em>(</em><em>ns_s</em><em>,</em><em>ns_d</em><em>) </em><em>numpy.ndarray</em>) – The distance (cost) cutoff between each source-destination species pair. All transports are restricted by the cutoffs.</p></li>
<li><p><strong>eps_p</strong> (<em>float</em><em>, </em><em>defaults to 1e-1</em>) – The coefficient for entropy regularization of P.</p></li>
<li><p><strong>eps_mu</strong> (<em>float</em><em>, </em><em>defaults to eps_p</em>) – The coefficient for entropy regularization of unmatched source mass.</p></li>
<li><p><strong>eps_nu</strong> (<em>float</em><em>, </em><em>defaults to eps_p</em>) – The coefficient for entriopy regularization of unmatched target mass.</p></li>
<li><p><strong>rho</strong> (<em>float</em><em>, </em><em>defaults to 1e2</em>) – The coefficient for penalizing unmatched mass.</p></li>
<li><p><strong>nitermax</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of iterations in the unormalized OT problem. Defaults to 1e4.</p></li>
<li><p><strong>stopthr</strong> (<em>float</em><em>, </em><em>optional</em>) – The relatitive error threshold for terminating the iteration. Defaults to 1e-8.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transport plans among the multiple species.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(ns_s,ns_d,n_pos_s,n_pos_d) numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.cot_row_dense">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">cot_row_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#cot_row_dense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.cot_row_dense" title="Permalink to this definition"></a></dt>
<dd><p>Solve for each sender species separately.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.cot_row_sparse">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">cot_row_sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#cot_row_sparse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.cot_row_sparse" title="Permalink to this definition"></a></dt>
<dd><p>Solve for each sender species separately.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.cot_sparse">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">cot_sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#cot_sparse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.cot_sparse" title="Permalink to this definition"></a></dt>
<dd><p>Solve the collective optimal transport problem with distance limits in sparse format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S</strong> (<em>(</em><em>n_pos_s</em><em>,</em><em>ns_s</em><em>) </em><em>numpy.ndarray</em>) – Source distributions over <cite>n_pos_s</cite> positions of <cite>ns_s</cite> source species.</p></li>
<li><p><strong>D</strong> (<em>(</em><em>n_pos_d</em><em>,</em><em>ns_d</em><em>) </em><em>numpy.ndarray</em>) – Destination distributions over <cite>n_pos_d</cite> positions of <cite>ns_d</cite> destination species.</p></li>
<li><p><strong>A</strong> (<em>(</em><em>ns_s</em><em>,</em><em>ns_d</em><em>) </em><em>numpy.ndarray</em>) – The cost coefficients for source-destination species pairs. An infinity value indicates that the two species cannot be coupled.</p></li>
<li><p><strong>M</strong> (<em>(</em><em>n_pos_s</em><em>,</em><em>n_pos_d</em><em>) </em><em>numpy.ndarray</em>) – The distance (cost) matrix among the positions.</p></li>
<li><p><strong>cutoff</strong> (<em>(</em><em>ns_s</em><em>,</em><em>ns_d</em><em>) </em><em>numpy.ndarray</em>) – The distance (cost) cutoff between each source-destination species pair. All transports are restricted by the cutoffs.</p></li>
<li><p><strong>eps_p</strong> (<em>float</em><em>, </em><em>defaults to 1e-1</em>) – The coefficient for entropy regularization of P.</p></li>
<li><p><strong>eps_mu</strong> (<em>float</em><em>, </em><em>defaults to eps_p</em>) – The coefficient for entropy regularization of unmatched source mass.</p></li>
<li><p><strong>eps_nu</strong> (<em>float</em><em>, </em><em>defaults to eps_p</em>) – The coefficient for entriopy regularization of unmatched target mass.</p></li>
<li><p><strong>rho</strong> (<em>float</em><em>, </em><em>defaults to 1e2</em>) – The coefficient for penalizing unmatched mass.</p></li>
<li><p><strong>nitermax</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of iterations in the unormalized OT problem. Defaults to 1e4.</p></li>
<li><p><strong>stopthr</strong> (<em>float</em><em>, </em><em>optional</em>) – The relatitive error threshold for terminating the iteration. Defaults to 1e-8.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transport plan in coo sparse format for source species i and destinaton species j can be retrieved with the key (i,j).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary of scipy.sparse.coo_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.regular_barycenter">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">regular_barycenter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#regular_barycenter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.regular_barycenter" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.run_p">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">run_p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#run_p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.run_p" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.unot">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">unot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse_mtx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sinkhorn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum_dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#unot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.unot" title="Permalink to this definition"></a></dt>
<dd><p>The main function calling different algorithms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>(</em><em>ns</em><em>,</em><em>) </em><em>numpy.ndarray</em>) – Source distribution. The summation should be less than or equal to 1.</p></li>
<li><p><strong>b</strong> (<em>(</em><em>nt</em><em>,</em><em>) </em><em>numpy.ndarray</em>) – Target distribution. The summation should be less than or equal to 1.</p></li>
<li><p><strong>C</strong> (<em>(</em><em>ns</em><em>,</em><em>nt</em><em>) </em><em>numpy.ndarray</em>) – The cost matrix possibly with infinity entries.</p></li>
<li><p><strong>eps_p</strong> (<em>float</em>) – The coefficient of entropy regularization for P.</p></li>
<li><p><strong>rho</strong> (<em>float</em>) – The coefficient of penalty for unmatched mass.</p></li>
<li><p><strong>eps_mu</strong> (<em>float</em><em>, </em><em>defaults to eps_p</em>) – The coefficient of entropy regularization for mu.</p></li>
<li><p><strong>eps_nu</strong> (<em>float</em><em>, </em><em>defaults to eps_p</em>) – The coefficient of entropy regularization for nu.</p></li>
<li><p><strong>sparse_mtx</strong> (<em>boolean</em><em>, </em><em>defaults to False</em>) – Whether using sparse matrix format. If True, C should be in coo_sparse format.</p></li>
<li><p><strong>solver</strong> (<em>str</em><em>, </em><em>defaults to 'sinkhorn'</em>) – The solver to use. Choose from ‘sinkhorn’ and ‘momentum’.</p></li>
<li><p><strong>nitermax</strong> (<em>int</em><em>, </em><em>defaults to 10000</em>) – The maximum number of iterations.</p></li>
<li><p><strong>stopthr</strong> (<em>float</em><em>, </em><em>defaults to 1e-8</em>) – The relative error threshold for stopping.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em><em>, </em><em>defaults to False</em>) – Whether to print algorithm logs.</p></li>
<li><p><strong>momentum_dt</strong> (<em>float</em><em>, </em><em>defaults to 1e-1</em>) – Step size if momentum method is used.</p></li>
<li><p><strong>momentum_beta</strong> (<em>float</em><em>, </em><em>defautls to 0</em>) – The coefficient for the momentum term if momemtum method is used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.unot_barycenter_sinkhorn_l1_dense">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">unot_barycenter_sinkhorn_l1_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#unot_barycenter_sinkhorn_l1_dense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.unot_barycenter_sinkhorn_l1_dense" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.unot_momentum_l1_2end_dense">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">unot_momentum_l1_2end_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#unot_momentum_l1_2end_dense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.unot_momentum_l1_2end_dense" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.unot_momentum_l1_dense">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">unot_momentum_l1_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precondition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#unot_momentum_l1_dense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.unot_momentum_l1_dense" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.unot_momentum_l2_dense">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">unot_momentum_l2_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#unot_momentum_l2_dense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.unot_momentum_l2_dense" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.unot_nesterov_l2_dense">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">unot_nesterov_l2_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#unot_nesterov_l2_dense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.unot_nesterov_l2_dense" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.unot_sinkhorn_l1_dense">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">unot_sinkhorn_l1_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_fg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#unot_sinkhorn_l1_dense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.unot_sinkhorn_l1_dense" title="Permalink to this definition"></a></dt>
<dd><p>Solve the unnormalized optimal transport with l1 penalty in dense matrix format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>(</em><em>ns</em><em>,</em><em>) </em><em>numpy.ndarray</em>) – Source distribution. The summation should be less than or equal to 1.</p></li>
<li><p><strong>b</strong> (<em>(</em><em>nt</em><em>,</em><em>) </em><em>numpy.ndarray</em>) – Target distribution. The summation should be less than or equal to 1.</p></li>
<li><p><strong>C</strong> (<em>(</em><em>ns</em><em>,</em><em>nt</em><em>) </em><em>numpy.ndarray</em>) – The cost matrix possibly with infinity entries.</p></li>
<li><p><strong>eps</strong> (<em>float</em>) – The coefficient for entropy regularization.</p></li>
<li><p><strong>m</strong> (<em>float</em>) – The coefficient for penalizing unmatched mass.</p></li>
<li><p><strong>nitermax</strong> (<em>int</em><em>, </em><em>optional</em>) – The max number of iterations. Defaults to 10000.</p></li>
<li><p><strong>stopthr</strong> (<em>float</em><em>, </em><em>optional</em>) – The threshold for terminating the iteration. Defaults to 1e-8.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The optimal transport matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(ns,nt) numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.unot_sinkhorn_l1_sparse">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">unot_sinkhorn_l1_sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#unot_sinkhorn_l1_sparse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.unot_sinkhorn_l1_sparse" title="Permalink to this definition"></a></dt>
<dd><p>Solve the unnormalized optimal transport with l1 penalty in sparse matrix format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>(</em><em>ns</em><em>,</em><em>) </em><em>numpy.ndarray</em>) – Source distribution. The summation should be less than or equal to 1.</p></li>
<li><p><strong>b</strong> (<em>(</em><em>nt</em><em>,</em><em>) </em><em>numpy.ndarray</em>) – Target distribution. The summation should be less than or equal to 1.</p></li>
<li><p><strong>C</strong> (<em>(</em><em>ns</em><em>,</em><em>nt</em><em>) </em><em>scipy.sparse.coo_matrix</em>) – The cost matrix in coo sparse format. The entries exceeds the cost cutoff are omitted. The naturally zero entries should be explicitely included.</p></li>
<li><p><strong>eps</strong> (<em>float</em>) – The coefficient for entropy regularization.</p></li>
<li><p><strong>m</strong> (<em>float</em>) – The coefficient for penalizing unmatched mass.</p></li>
<li><p><strong>nitermax</strong> (<em>int</em><em>, </em><em>optional</em>) – The max number of iterations. Defaults to 10000.</p></li>
<li><p><strong>stopthr</strong> (<em>float</em><em>, </em><em>optional</em>) – The threshold for terminating the iteration. Defaults to 1e-8.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The optimal transport matrix. The locations of entries should agree with C and there might by explicit zero entries.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(ns,nt) scipy.sparse.coo_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.unot_sinkhorn_l2_dense">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">unot_sinkhorn_l2_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#unot_sinkhorn_l2_dense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.unot_sinkhorn_l2_dense" title="Permalink to this definition"></a></dt>
<dd><p>Solve the unnormalized optimal transport with l2 penalty in dense matrix format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>(</em><em>ns</em><em>,</em><em>) </em><em>numpy.ndarray</em>) – Source distribution. The summation should be less than or equal to 1.</p></li>
<li><p><strong>b</strong> (<em>(</em><em>nt</em><em>,</em><em>) </em><em>numpy.ndarray</em>) – Target distribution. The summation should be less than or equal to 1.</p></li>
<li><p><strong>C</strong> (<em>(</em><em>ns</em><em>,</em><em>nt</em><em>) </em><em>numpy.ndarray</em>) – The cost matrix possibly with infinity entries.</p></li>
<li><p><strong>eps</strong> (<em>float</em>) – The coefficient for entropy regularization.</p></li>
<li><p><strong>m</strong> (<em>float</em>) – The coefficient for penalizing unmatched mass.</p></li>
<li><p><strong>nitermax</strong> (<em>int</em><em>, </em><em>optional</em>) – The max number of iterations. Defaults to 10000.</p></li>
<li><p><strong>stopthr</strong> (<em>float</em><em>, </em><em>optional</em>) – The threshold for terminating the iteration. Defaults to 1e-8.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The optimal transport matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(ns,nt) numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.ot.unot_sinkhorn_l2_sparse">
<span class="sig-prename descclassname"><span class="pre">spider.ot.</span></span><span class="sig-name descname"><span class="pre">unot_sinkhorn_l2_sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopthr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/ot.html#unot_sinkhorn_l2_sparse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.ot.unot_sinkhorn_l2_sparse" title="Permalink to this definition"></a></dt>
<dd><p>Solve the unnormalized optimal transport with l2 penalty in sparse matrix format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>(</em><em>ns</em><em>,</em><em>) </em><em>numpy.ndarray</em>) – Source distribution. The summation should be less than or equal to 1.</p></li>
<li><p><strong>b</strong> (<em>(</em><em>nt</em><em>,</em><em>) </em><em>numpy.ndarray</em>) – Target distribution. The summation should be less than or equal to 1.</p></li>
<li><p><strong>C</strong> (<em>(</em><em>ns</em><em>,</em><em>nt</em><em>) </em><em>scipy.sparse.coo_matrix</em>) – The cost matrix in coo sparse format. The entries exceeds the cost cutoff are omitted. The naturally zero entries should be explicitely included.</p></li>
<li><p><strong>eps</strong> (<em>float</em>) – The coefficient for entropy regularization.</p></li>
<li><p><strong>m</strong> (<em>float</em>) – The coefficient for penalizing unmatched mass.</p></li>
<li><p><strong>nitermax</strong> (<em>int</em><em>, </em><em>optional</em>) – The max number of iterations. Defaults to 10000.</p></li>
<li><p><strong>stopthr</strong> (<em>float</em><em>, </em><em>optional</em>) – The threshold for terminating the iteration. Defaults to 1e-8.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The optimal transport matrix. The locations of entries should agree with C and there might by explicit zero entries.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(ns,nt) scipy.sparse.coo_matrix</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-spider.preprocess">
<span id="spider-preprocess-module"></span><h2>spider.preprocess module<a class="headerlink" href="#module-spider.preprocess" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.algebraic_mean">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">algebraic_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">related_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#algebraic_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.algebraic_mean" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.algebraic_mean_v1">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">algebraic_mean_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#algebraic_mean_v1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.algebraic_mean_v1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.build_neighbors">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">build_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#build_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.build_neighbors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.find_interfaces">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">find_interfaces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_sc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#find_interfaces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.find_interfaces" title="Permalink to this definition"></a></dt>
<dd><p>Identify interfaces between cells based on interaction capacity and spatial distance.</p>
<p>This function locates interfaces between cells by analyzing interaction capacity and
their spatial distances. It applies filtering based on a specified cutoff distance and
can optionally include self-interaction pairs for bulk ST data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – Input AnnData object containing spatial and expression data.</p></li>
<li><p><strong>cluster_key</strong> (<em>str</em>) – Key in <cite>adata.obs</cite> that specifies the clustering information for the cells.</p></li>
<li><p><strong>lr_df</strong> (<em>DataFrame</em>) – DataFrame containing ligand-receptor pairs to be analyzed.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Distance cutoff for filtering interfaces (default is None). If not specified,
the cutoff is determined based on the distribution of distances.</p></li>
<li><p><strong>is_sc</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, self-interaction pairs are not included (default is False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>pairs</strong> (<em>ndarray</em>) – Array of identified cell pairs representing interfaces.</p></li>
<li><p><strong>pairs_meta</strong> (<em>DataFrame</em>) – DataFrame containing metadata for the identified interfaces, including distances.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function calculates a median distance and uses it to filter out low-capacity cells
and their interfaces.</p></li>
<li><p>Gaussian Mixture Models (GMM) are used to estimate the ideal number of interfaces
based on the capacity of the cells.</p></li>
<li><p>If <cite>is_sc</cite> is False, self-interaction pairs are added to the results.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pairs</span><span class="p">,</span> <span class="n">pairs_meta</span> <span class="o">=</span> <span class="n">find_interfaces</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="s1">&#39;cluster_key&#39;</span><span class="p">,</span> <span class="n">lr_df</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.find_pairs_v1">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">find_pairs_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'generic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#find_pairs_v1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.find_pairs_v1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.get_interface_neighbors">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">get_interface_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interface_meta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#get_interface_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.get_interface_neighbors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.get_power_circumcenter">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">get_power_circumcenter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#get_power_circumcenter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.get_power_circumcenter" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.get_triangle_normal">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">get_triangle_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#get_triangle_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.get_triangle_normal" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.idata_construct">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">idata_construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pairs_meta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_raw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pathway_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_total</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#idata_construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.idata_construct" title="Permalink to this definition"></a></dt>
<dd><p>Constructs an AnnData object for interface profiles from input data.</p>
<p>This function takes scores and metadata to create an AnnData object,
setting various attributes and performing quality checks on the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>score</strong> (<em>np.ndarray</em>) – A 2D array of scores representing the interaction strengths between ligand-receptor pairs.</p></li>
<li><p><strong>direction</strong> (<em>np.ndarray</em>) – A 2D array indicating the direction of interactions for the respective scores.</p></li>
<li><p><strong>pairs_meta</strong> (<em>pd.DataFrame</em>) – A DataFrame containing metadata for ligand-receptor pairs, which should include relevant identifiers.</p></li>
<li><p><strong>lr_df</strong> (<em>pd.DataFrame</em>) – A DataFrame containing ligand-receptor information, with indices corresponding to ligand-receptor pairs.</p></li>
<li><p><strong>lr_raw</strong> (<em>pd.DataFrame</em>) – Raw metadata for ligand-receptor pairs, used for further analysis and storage in the output AnnData object.</p></li>
<li><p><strong>pathway_df</strong> (<em>pd.DataFrame</em>) – A DataFrame containing pathway information that describes interactions between transcription factors and genes.</p></li>
<li><p><strong>adata</strong> (<em>AnnData</em>) – The original AnnData object containing the input data for the analysis.</p></li>
<li><p><strong>drop</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, drops cells that do not have any expressed genes (default is True).</p></li>
<li><p><strong>normalize_total</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, normalizes the total counts of interactions in the AnnData object (default is False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>idata</strong> – The constructed AnnData object containing the following:
- Scores and directions as layers.
- Metadata and quality metrics for interfaces.
- Spatial coordinates if available.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>AnnData</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function performs quality checks on the data, filtering genes and cells based on specified criteria.</p></li>
<li><p>It normalizes total interaction strengths per interface if the <cite>normalize_total</cite> flag is set to True.</p></li>
<li><p>The function constructs the output AnnData object (<cite>idata</cite>) with appropriate metadata for downstream analysis.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">idata</span> <span class="o">=</span> <span class="n">idata_construct</span><span class="p">(</span><span class="n">score_array</span><span class="p">,</span> <span class="n">direction_array</span><span class="p">,</span> <span class="n">pairs_meta_df</span><span class="p">,</span> <span class="n">lr_df</span><span class="p">,</span> <span class="n">lr_raw_df</span><span class="p">,</span> <span class="n">pathway_df</span><span class="p">,</span> <span class="n">adata</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.impute_MAGIC">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">impute_MAGIC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#impute_MAGIC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.impute_MAGIC" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.is_ccw_triangle">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">is_ccw_triangle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#is_ccw_triangle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.is_ccw_triangle" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.kernel_function">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">kernel_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#kernel_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.kernel_function" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.load_lr_df">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">load_lr_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_human</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#load_lr_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.load_lr_df" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.load_pathway_df">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">load_pathway_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_human</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#load_pathway_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.load_pathway_df" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.meta">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">meta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pairs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#meta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.meta" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.norm2">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">norm2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#norm2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.norm2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.normalized">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">normalized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#normalized"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.normalized" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.power_tri_init">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">power_tri_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#power_tri_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.power_tri_init" title="Permalink to this definition"></a></dt>
<dd><p>Initialize power triangulation based on interaction capacity and spatial data.</p>
<p>This function computes the power triangulation for a set of cells based on their
spatial coordinates and ligand-receptor (LR) capacities. It normalizes the capacities,
computes lifted weighted points, and determines the convex hull and Delaunay triangulation
to identify interactions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – Input AnnData object containing spatial coordinates and expression data.</p></li>
<li><p><strong>lr_df</strong> (<em>DataFrame</em>) – DataFrame containing ligand-receptor pairs to be analyzed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pairs</strong> – Array of unique pairs of cell indices representing power triangulation edges.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function normalizes the ligand-receptor capacity per cell and computes a minimum
distance based on spatial coordinates.</p></li>
<li><p>The lifted weighted points are calculated from the spatial data and capacities.</p></li>
<li><p>The convex hull is computed to extract the Delaunay triangulation, which is then used
to generate unique cell pairs representing interfaces.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pairs</span> <span class="o">=</span> <span class="n">power_tri_init</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">lr_df</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.score">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pairs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interface_meta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.score_ot">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">score_ot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interface_meta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interface_cell_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#score_ot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.score_ot" title="Permalink to this definition"></a></dt>
<dd><p>Score interactions and directions between ligands and receptors based on spatial data.</p>
<p>This function evaluates the interactions between ligands and receptors in the provided
AnnData object, using a COT scoring mechanism that incorporates spatial information and
co-expression data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – Input AnnData object containing expression data and spatial coordinates.</p></li>
<li><p><strong>lr_df</strong> (<em>DataFrame</em>) – DataFrame containing ligand-receptor pairs to be analyzed.</p></li>
<li><p><strong>interface_meta</strong> (<em>DataFrame</em>) – Metadata associated with the interface analysis (not directly used in scoring).</p></li>
<li><p><strong>interface_cell_pair</strong> (<em>DataFrame</em>) – A DataFrame containing pairs of cell indices for which interactions are to be scored.</p></li>
<li><p><strong>weight</strong> (<em>tuple</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Weights for the scoring components (default is (0.25, 0.25, 0.25, 0.25)).</p></li>
<li><p><strong>itermax</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of iterations for the scoring algorithm (default is 1000).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>idata_score</strong> (<em>ndarray</em>) – A 2D numpy array containing the interaction scores for each ligand-receptor pair.</p></li>
<li><p><strong>idata_direction</strong> (<em>ndarray</em>) – A 2D numpy array indicating the direction (e.g., ligand or receptor dominance)
of each interaction.</p></li>
<li><p><strong>comm_network</strong> (<em>dict</em>) – A dictionary representing the combined communication network, mapping
ligand-receptor pairs to their scores.</p></li>
<li><p><strong>S</strong> (<em>ndarray</em>) – A 2D numpy array of gene expression values for ligands.</p></li>
<li><p><strong>D</strong> (<em>ndarray</em>) – A 2D numpy array of gene expression values for receptors.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The scoring mechanism relies on the spatial proximity of cells, calculating distances
between pairs of cells to inform the scoring.</p></li>
<li><p>Ligand-receptor interactions are evaluated based on COT and their co-expression in the spatial
context of the cells.</p></li>
<li><p>The output includes normalized scores for interactions and a directionality indicator.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">interaction_scores</span><span class="p">,</span> <span class="n">interaction_directions</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">score_ot</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">lr_df</span><span class="p">,</span> <span class="n">interface_meta</span><span class="p">,</span> <span class="n">interface_cell_pair</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.score_ot_entropy">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">score_ot_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interface_meta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interface_cell_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#score_ot_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.score_ot_entropy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.score_ot_weighted">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">score_ot_weighted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interface_meta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interface_cell_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#score_ot_weighted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.score_ot_weighted" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.score_v1">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">score_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pairs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#score_v1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.score_v1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.subset_adata">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">subset_adata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pathway_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imputation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_total</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#subset_adata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.subset_adata" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.subset_lr">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">subset_lr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_human</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#subset_lr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.subset_lr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.preprocess.subset_pathway_df">
<span class="sig-prename descclassname"><span class="pre">spider.preprocess.</span></span><span class="sig-name descname"><span class="pre">subset_pathway_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pathways</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/preprocess.html#subset_pathway_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.preprocess.subset_pathway_df" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-spider.svi">
<span id="spider-svi-module"></span><h2>spider.svi module<a class="headerlink" href="#module-spider.svi" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.ELBO">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">ELBO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2e_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#ELBO"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.ELBO" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.Q_Z_expectation">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">Q_Z_expectation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#Q_Z_expectation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.Q_Z_expectation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.Q_mu_expectation">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">Q_mu_expectation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2e</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#Q_mu_expectation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.Q_mu_expectation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.Q_mu_k_expectation">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">Q_mu_k_expectation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2e</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#Q_mu_k_expectation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.Q_mu_k_expectation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.SE_kernel">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">SE_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#SE_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.SE_kernel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.SVI_patterns">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">SVI_patterns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svi_df_strict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern_prune_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predefined_pattern_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#SVI_patterns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.SVI_patterns" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.SVI_patterns_v1">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">SVI_patterns_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svi_df_strict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#SVI_patterns_v1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.SVI_patterns_v1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.SVI_patterns_v2">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">SVI_patterns_v2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svi_df_strict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern_prune_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predefined_pattern_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#SVI_patterns_v2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.SVI_patterns_v2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.abstract">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">abstract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#abstract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.abstract" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.algebraic_mean">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">algebraic_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">related_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#algebraic_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.algebraic_mean" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.combine_SVI">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">combine_SVI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svi_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#combine_SVI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.combine_SVI" title="Permalink to this definition"></a></dt>
<dd><p>Combine SVIs based on both SV candidates and TF support.</p>
<p>This function attempts to identify SVIs from the
given input data. It first uses strict filtering, then falls back to relaxed filtering
or SOMDE results if the detected number of SVIs is below a specified threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idata</strong> (<em>AnnData</em>) – Input AnnData object containing interaction data.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Threshold value for filtering SVI candidates based on significance.</p></li>
<li><p><strong>svi_number</strong> (<em>int</em><em>, </em><em>optional</em>) – The mimimum number of SVIs to identify (default is 10). The function will
attempt to ensure that at least this many SVIs are returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>svi_df</strong> (<em>DataFrame</em>) – DataFrame containing results of all LRIs.</p></li>
<li><p><strong>svi_df_strict</strong> (<em>DataFrame</em>) – DataFrame containing strictly filtered SVIs based on the provided threshold and TF support.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function checks the number of detected SVIs and applies different filtering
strategies if the count is less than <cite>svi_number</cite>.</p></li>
<li><p>If TF support counts are available, genes without TF support are excluded from
the strict SVI results.</p></li>
<li><p>Updates the <cite>is_svi</cite> column in <cite>idata.var</cite> to indicate which genes are identified as SVIs.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">svi_df</span><span class="p">,</span> <span class="n">svi_df_strict</span> <span class="o">=</span> <span class="n">combine_SVI</span><span class="p">(</span><span class="n">idata</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">svi_number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.combine_SVI_Fisher">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">combine_SVI_Fisher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#combine_SVI_Fisher"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.combine_SVI_Fisher" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.combine_SVI_Stouffer">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">combine_SVI_Stouffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#combine_SVI_Stouffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.combine_SVI_Stouffer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.combine_SVI_somde">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">combine_SVI_somde</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#combine_SVI_somde"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.combine_SVI_somde" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.combine_SVI_strict">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">combine_SVI_strict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#combine_SVI_strict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.combine_SVI_strict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.count_tf">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">count_tf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#count_tf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.count_tf" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="spider.svi.dotdict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">dotdict</span></span><a class="reference internal" href="_modules/spider/svi.html#dotdict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.dotdict" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
<p>dot.notation access to dictionary attributes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.eva_SVI">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">eva_SVI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svi_df_strict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#eva_SVI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.eva_SVI" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.eva_SVI_notf">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">eva_SVI_notf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svi_df_strict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#eva_SVI_notf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.eva_SVI_notf" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.eva_pattern">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">eva_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#eva_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.eva_pattern" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.factor">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">K</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.factor" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.find_svi">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">find_svi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">som</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#find_svi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.find_svi" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.fit_patterns">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">fit_patterns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2e_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">printerval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_elbo_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#fit_patterns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.fit_patterns" title="Permalink to this definition"></a></dt>
<dd><p>Fit spatial patterns using Automatic Expression Histology.
X : Spatial coordinates
Y : Gene expression values
C : The number of patterns
l : The charancteristic length scale of the clusters
Returns
final_elbo : The final ELBO value.
m : The posterior mean underlying expression values for each cluster.
r : The posterior pattern assignment probabilities for each gene and pattern.
s2e : The estimated noise parameter of the model</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.get_ref_hops">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">get_ref_hops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pathways</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique_genes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_to_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#get_ref_hops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.get_ref_hops" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.idata_pattern_to_spot">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">idata_pattern_to_spot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#idata_pattern_to_spot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.idata_pattern_to_spot" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.kernel_function">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">kernel_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#kernel_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.kernel_function" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.ln_P_YZms">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">ln_P_YZms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#ln_P_YZms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.ln_P_YZms" title="Permalink to this definition"></a></dt>
<dd><p>Expecation of ln P(Y | Z, mu, s2e)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.ln_P_Z">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">ln_P_Z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#ln_P_Z"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.ln_P_Z" title="Permalink to this definition"></a></dt>
<dd><p>Expectation of ln P(Z)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.ln_P_mu">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">ln_P_mu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#ln_P_mu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.ln_P_mu" title="Permalink to this definition"></a></dt>
<dd><p>Expectation of ln P(mu)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.ln_Q_Z">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">ln_Q_Z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#ln_Q_Z"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.ln_Q_Z" title="Permalink to this definition"></a></dt>
<dd><p>Expectation of ln Q(Z)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.ln_Q_mu">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">ln_Q_mu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2e</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#ln_Q_mu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.ln_Q_mu" title="Permalink to this definition"></a></dt>
<dd><p>Expecation of ln Q(mu)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.load_pathway_df">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">load_pathway_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_human</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#load_pathway_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.load_pathway_df" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.make_elbojective">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">make_elbojective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2e_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#make_elbojective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.make_elbojective" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.meta_pattern_to_idata">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">meta_pattern_to_idata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_idata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#meta_pattern_to_idata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.meta_pattern_to_idata" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.pattern_label_corr">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">pattern_label_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#pattern_label_corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.pattern_label_corr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.process_cell">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">process_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique_genes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sv_target_genes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_sv_tf_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hop1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_hop1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_hop2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_hop3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sv_target_genes_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_name_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudo_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#process_cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.process_cell" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.process_receptor">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">process_receptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">major_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_top_score</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#process_receptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.process_receptor" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.run_cells">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">run_cells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norm_exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique_genes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sv_target_genes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_sv_tf_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hop1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_hop1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_hop2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_hop3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sv_target_genes_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_name_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#run_cells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.run_cells" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.run_receptors">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">run_receptors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">major_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_top_score</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#run_receptors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.run_receptors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.scGCO_log1p">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">scGCO_log1p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#scGCO_log1p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.scGCO_log1p" title="Permalink to this definition"></a></dt>
<dd><p>log transform normalized count data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> – data (m, n);</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>data (m, n);</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.scGCO_normalize_count_cellranger">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">scGCO_normalize_count_cellranger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#scGCO_normalize_count_cellranger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.scGCO_normalize_count_cellranger" title="Permalink to this definition"></a></dt>
<dd><p>normalize count as in cellranger</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> – data: A dataframe of shape (m, n);</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>data shape (m, n);</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.scGCO_sv">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">scGCO_sv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">locs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellGraph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmmDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unary_scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'expansion'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#scGCO_sv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.scGCO_sv" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.som_mapping">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">som_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">som</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#som_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.som_mapping" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.spatial_patterns">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">spatial_patterns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DE_mll_results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#spatial_patterns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.spatial_patterns" title="Permalink to this definition"></a></dt>
<dd><p>Group spatially variable genes into spatial patterns using
automatic expression histology (AEH).
X : Spatial coordinates
exp_mat : Expression matrix, appropriately normalised.
DE_mll_results : Results table from SpatialDE, after filtering</p>
<blockquote>
<div><p>for significance level.</p>
</div></blockquote>
<p>C : The number of spatial patterns
<a href="#id1"><span class="problematic" id="id2">**</span></a>kwards are passed on to the function fit_patterns()
Returns
pattern_results : A DataFrame with pattern membership information</p>
<blockquote>
<div><p>for each gene</p>
</div></blockquote>
<dl class="simple">
<dt>patterns<span class="classifier">The posterior mean underlying expression for genes in</span></dt><dd><p>given spatial patterns.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.subset_pathway_df">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">subset_pathway_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pathways</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#subset_pathway_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.subset_pathway_df" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.svi_SOMDE">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">svi_SOMDE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">som</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#svi_SOMDE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.svi_SOMDE" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.svi_SPARKX">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">svi_SPARKX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#svi_SPARKX"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.svi_SPARKX" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.svi_SpatialDE">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">svi_SpatialDE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#svi_SpatialDE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.svi_SpatialDE" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.svi_SpatialDE2">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">svi_SpatialDE2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#svi_SpatialDE2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.svi_SpatialDE2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.svi_SpatialDE2_omnibus">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">svi_SpatialDE2_omnibus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#svi_SpatialDE2_omnibus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.svi_SpatialDE2_omnibus" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.svi_geary">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">svi_geary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#svi_geary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.svi_geary" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.svi_moran">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">svi_moran</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#svi_moran"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.svi_moran" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.svi_nnSVG">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">svi_nnSVG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#svi_nnSVG"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.svi_nnSVG" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.svi_scGCO">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">svi_scGCO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">work_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#svi_scGCO"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.svi_scGCO" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.tf_corr">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">tf_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_human</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pathways</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_top_score</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#tf_corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.tf_corr" title="Permalink to this definition"></a></dt>
<dd><p>Compute transcription factor correlations with ligand-receptor interactions.</p>
<p>This function analyzes the given interface data and evaluates the correlations
between each interaction profile and their target genes, saving the results to
specified output files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idata</strong> (<em>AnnData</em>) – Input AnnData object containing interface data.</p></li>
<li><p><strong>adata</strong> (<em>AnnData</em>) – Input AnnData object containing count data.</p></li>
<li><p><strong>is_human</strong> (<em>bool</em>) – Indicator for whether the data pertains to human genes.</p></li>
<li><p><strong>out_f</strong> (<em>str</em>) – Output directory path where results will be saved.</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum correlation coefficient threshold for calling TF support (default is 0.3).</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of parallel jobs to run during processing (default is 20).</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, existing output files will be overwritten (default is False).</p></li>
<li><p><strong>step</strong> (<em>float</em><em>, </em><em>optional</em>) – The step size for adjusting the threshold during the iterative process (default is None).</p></li>
<li><p><strong>pathways</strong> (<em>list</em><em>, </em><em>optional</em>) – A list of pathways to analyze; if empty, pathways will be loaded based on the input data.</p></li>
<li><p><strong>keep_top_score</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of top scoring interactions to retain (default is None).</p></li>
<li><p><strong>smooth</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, applies smoothing to the expression data (default is False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The function saves results directly to the specified output files and updates
the <cite>idata</cite> object with correlation and score data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function checks if the output directory exists and creates it if it does not.</p></li>
<li><p>If smoothing is enabled, it applies a kernel smoothing method based on spatial data.</p></li>
<li><p>Results are saved in sparse matrix format and CSV files for easy access and further analysis.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tf_corr</span><span class="p">(</span><span class="n">idata</span><span class="p">,</span> <span class="n">adata</span><span class="p">,</span> <span class="n">adata</span><span class="o">.</span><span class="n">uns</span><span class="p">[</span><span class="s1">&#39;is_human&#39;</span><span class="p">],</span> <span class="s1">&#39;output_directory/&#39;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keep_top_score</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.svi.tf_pattern_to_idata">
<span class="sig-prename descclassname"><span class="pre">spider.svi.</span></span><span class="sig-name descname"><span class="pre">tf_pattern_to_idata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata_raw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/svi.html#tf_pattern_to_idata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.svi.tf_pattern_to_idata" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-spider.util">
<span id="spider-util-module"></span><h2>spider.util module<a class="headerlink" href="#module-spider.util" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spider.util.adata_moranI">
<span class="sig-prename descclassname"><span class="pre">spider.util.</span></span><span class="sig-name descname"><span class="pre">adata_moranI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/util.html#adata_moranI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.util.adata_moranI" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.util.compare_local_var">
<span class="sig-prename descclassname"><span class="pre">spider.util.</span></span><span class="sig-name descname"><span class="pre">compare_local_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idata_old</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/util.html#compare_local_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.util.compare_local_var" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.util.compare_var">
<span class="sig-prename descclassname"><span class="pre">spider.util.</span></span><span class="sig-name descname"><span class="pre">compare_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idata_old</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/util.html#compare_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.util.compare_var" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.util.get_marker_df">
<span class="sig-prename descclassname"><span class="pre">spider.util.</span></span><span class="sig-name descname"><span class="pre">get_marker_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfoldchanges_threhold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/util.html#get_marker_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.util.get_marker_df" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.util.interaction_spot_interface">
<span class="sig-prename descclassname"><span class="pre">spider.util.</span></span><span class="sig-name descname"><span class="pre">interaction_spot_interface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/util.html#interaction_spot_interface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.util.interaction_spot_interface" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.util.relabel_interface">
<span class="sig-prename descclassname"><span class="pre">spider.util.</span></span><span class="sig-name descname"><span class="pre">relabel_interface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clust_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/util.html#relabel_interface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.util.relabel_interface" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.util.save_runningtime">
<span class="sig-prename descclassname"><span class="pre">spider.util.</span></span><span class="sig-name descname"><span class="pre">save_runningtime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/util.html#save_runningtime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.util.save_runningtime" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.util.scored_spot_interface">
<span class="sig-prename descclassname"><span class="pre">spider.util.</span></span><span class="sig-name descname"><span class="pre">scored_spot_interface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/util.html#scored_spot_interface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.util.scored_spot_interface" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-spider.version">
<span id="spider-version-module"></span><h2>spider.version module<a class="headerlink" href="#module-spider.version" title="Permalink to this heading"></a></h2>
</section>
<section id="module-spider.visualization">
<span id="spider-visualization-module"></span><h2>spider.visualization module<a class="headerlink" href="#module-spider.visualization" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spider.visualization.compare_interface_capacity">
<span class="sig-prename descclassname"><span class="pre">spider.visualization.</span></span><span class="sig-name descname"><span class="pre">compare_interface_capacity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idata_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/visualization.html#compare_interface_capacity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.visualization.compare_interface_capacity" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.visualization.compare_ot_coexp">
<span class="sig-prename descclassname"><span class="pre">spider.visualization.</span></span><span class="sig-name descname"><span class="pre">compare_ot_coexp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diff_local</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/visualization.html#compare_ot_coexp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.visualization.compare_ot_coexp" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.visualization.compare_ot_coexp_v1">
<span class="sig-prename descclassname"><span class="pre">spider.visualization.</span></span><span class="sig-name descname"><span class="pre">compare_ot_coexp_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata_ot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idata_coexp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/visualization.html#compare_ot_coexp_v1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.visualization.compare_ot_coexp_v1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.visualization.ct_pie">
<span class="sig-prename descclassname"><span class="pre">spider.visualization.</span></span><span class="sig-name descname"><span class="pre">ct_pie</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_self</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/visualization.html#ct_pie"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.visualization.ct_pie" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.visualization.ct_pies">
<span class="sig-prename descclassname"><span class="pre">spider.visualization.</span></span><span class="sig-name descname"><span class="pre">ct_pies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/visualization.html#ct_pies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.visualization.ct_pies" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.visualization.enrichment">
<span class="sig-prename descclassname"><span class="pre">spider.visualization.</span></span><span class="sig-name descname"><span class="pre">enrichment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ordered_group'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_term</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/visualization.html#enrichment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.visualization.enrichment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.visualization.paga_compare">
<span class="sig-prename descclassname"><span class="pre">spider.visualization.</span></span><span class="sig-name descname"><span class="pre">paga_compare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/visualization.html#paga_compare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.visualization.paga_compare" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.visualization.pattern_LRI">
<span class="sig-prename descclassname"><span class="pre">spider.visualization.</span></span><span class="sig-name descname"><span class="pre">pattern_LRI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obsm_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pattern_score'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_SVI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spot_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/visualization.html#pattern_LRI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.visualization.pattern_LRI" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.visualization.pattern_chord">
<span class="sig-prename descclassname"><span class="pre">spider.visualization.</span></span><span class="sig-name descname"><span class="pre">pattern_chord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/visualization.html#pattern_chord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.visualization.pattern_chord" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.visualization.plot_projection">
<span class="sig-prename descclassname"><span class="pre">spider.visualization.</span></span><span class="sig-name descname"><span class="pre">plot_projection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/visualization.html#plot_projection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.visualization.plot_projection" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.visualization.plot_top_tf">
<span class="sig-prename descclassname"><span class="pre">spider.visualization.</span></span><span class="sig-name descname"><span class="pre">plot_top_tf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_tf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spot_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/visualization.html#plot_top_tf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.visualization.plot_top_tf" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.visualization.quiver_pattern">
<span class="sig-prename descclassname"><span class="pre">spider.visualization.</span></span><span class="sig-name descname"><span class="pre">quiver_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obsm_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pattern_score'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_SVI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/visualization.html#quiver_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.visualization.quiver_pattern" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.visualization.rotate_label">
<span class="sig-prename descclassname"><span class="pre">spider.visualization.</span></span><span class="sig-name descname"><span class="pre">rotate_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/visualization.html#rotate_label"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.visualization.rotate_label" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.visualization.svg_svi_relation">
<span class="sig-prename descclassname"><span class="pre">spider.visualization.</span></span><span class="sig-name descname"><span class="pre">svg_svi_relation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_human</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/visualization.html#svg_svi_relation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.visualization.svg_svi_relation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.visualization.traj_proj">
<span class="sig-prename descclassname"><span class="pre">spider.visualization.</span></span><span class="sig-name descname"><span class="pre">traj_proj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/visualization.html#traj_proj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.visualization.traj_proj" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.visualization.vis_ct_chord">
<span class="sig-prename descclassname"><span class="pre">spider.visualization.</span></span><span class="sig-name descname"><span class="pre">vis_ct_chord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svi</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/visualization.html#vis_ct_chord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.visualization.vis_ct_chord" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spider.visualization.viz_interface_pattern">
<span class="sig-prename descclassname"><span class="pre">spider.visualization.</span></span><span class="sig-name descname"><span class="pre">viz_interface_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['row',</span> <span class="pre">'col']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">histology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/spider/visualization.html#viz_interface_pattern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spider.visualization.viz_interface_pattern" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-spider">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-spider" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Li Shiying.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>